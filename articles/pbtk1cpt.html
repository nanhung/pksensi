<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>One-compartment PK model • pksensi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One-compartment PK model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pksensi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pbpk_apap.html">Acetaminophen-PBPK model</a></li>
    <li><a class="dropdown-item" href="../articles/pbtk1cpt.html">One-compartment PK model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nanhung/pksensi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>One-compartment PK model</h1>
                        <h4 data-toc-skip class="author">Nan-Hung
Hsieh</h4>
            
            <h4 data-toc-skip class="date">2024-11-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanhung/pksensi/blob/master/vignettes/pbtk1cpt.Rmd" class="external-link"><code>vignettes/pbtk1cpt.Rmd</code></a></small>
      <div class="d-none name"><code>pbtk1cpt.Rmd</code></div>
    </div>

    
    
<p>In this example, we use a generic, one-compartment PK model from
<strong>httk</strong> package <span class="citation">(Pearce et al.
2017)</span> to demonstrate how <strong>pksensi</strong> can be applied
to pharmacokinetic studies.</p>
<div class="section level2">
<h2 id="equations">Equations<a class="anchor" aria-label="anchor" href="#equations"></a>
</h2>
<p>The differential equations for the one-compartment PK model can be
written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>A</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>l</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msub><mi>k</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>a</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>⋅</mo><msub><mi>A</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>l</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{dA_{gutlumen}}{dt} = -k_{gutabs} \cdot A_{gutlumen} + g(t)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><msub><mi>k</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>a</mi><mi>b</mi><mi>s</mi></mrow></msub><msub><mi>V</mi><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi></mrow></msub></mfrac><mo>−</mo><msub><mi>k</mi><mrow><mi>e</mi><mi>l</mi><mi>i</mi><mi>m</mi></mrow></msub><mo>⋅</mo><msub><mi>C</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\frac{dC_{rest}}{dt} = \frac{k_{gutabs}}{V_{dist}}-k_{elim} \cdot C_{rest}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>l</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">A_{gutlumen}</annotation></semantics></math>
is the state variable that describes the quantity of compound in the gut
lumen (mg) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">A_{rest}</annotation></semantics></math>
is the quantity of compound in rest of body and blood (mg). The
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mrow><mi>g</mi><mi>u</mi><mi>t</mi><mi>a</mi><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">k_{gutabs}</annotation></semantics></math>
is the absorption rate constant that describes the chemical absorption
from the gut lumen into gut tissue through first-order processes (/h)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mrow><mi>e</mi><mi>l</mi><mi>i</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">k_{elim}</annotation></semantics></math>
is the elimination rate constant (/h), which is equal to the total
clearance divided by the volume of distribution. The time-dependent
function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(t)</annotation></semantics></math>
is used to describe the oral dosing schedule.</p>
<p>The concentration of the chemical in the rest of body and blood
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">C_{rest}</annotation></semantics></math>,
mg/L) can be calculated as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><mi>/</mi><msub><mi>V</mi><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>⋅</mo><mi>B</mi><mi>W</mi></mrow><annotation encoding="application/x-tex"> C_{rest} = A_{rest} / V_{dist} \cdot BW</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">V_{dist}</annotation></semantics></math>
is the volume of distribution (L/kg BW) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>W</mi></mrow><annotation encoding="application/x-tex">BW</annotation></semantics></math>
is the body weight (kg). The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">C_{rest}</annotation></semantics></math>
can also be seen as the chemical concentration in plasma that can be
further used to compare with observed results in a pharmacokinetic
experiment. The bioavailability is assumed to be 100% in this model.</p>
</div>
<div class="section level2">
<h2 id="model-implementations-with-desolve-solving-engine">Model implementations with <strong>deSolve</strong> solving
engine<a class="anchor" aria-label="anchor" href="#model-implementations-with-desolve-solving-engine"></a>
</h2>
<p>To start, we implemented the one-compartment PK model in R. The
<strong>pksensi</strong> allows users select the preferred method to
solve the PK model, either with the <strong>deSolve</strong> <span class="citation">(Soetaert, Petzoldt, and Setzer 2010)</span> package or
with <strong>GNU MCSim</strong> <span class="citation">(Bois and Maszle
1997)</span> through the compile function. This section will show how to
conduct global SA with pure R and GNU MCSim model code.</p>
<div class="section level3">
<h3 id="pure-r-model-code">Pure R model code<a class="anchor" aria-label="anchor" href="#pure-r-model-code"></a>
</h3>
<p>The one-compartment PK model can describe the quantity of compound in
the gut lumen (<code>Agutlument</code>) and the rest of body
(<code>Acompartmant</code>). The <code>Ametabolized</code> is the
quantity of compound transform and metabolize through hepatic clearance.
The model mainly includes two state variables that are the quantity of
compound in the gut lumen (<code>Agutlument</code>) and the rest of body
(<code>Acompartmant</code>). The <code>Ametabolized</code> is the
quantity of compound transform and metabolize through hepatic
clearance.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbtk1cpt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">state</span>, <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">parameters</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span></span>
<span>    <span class="va">dAgutlument</span> <span class="op">=</span> <span class="op">-</span> <span class="va">kgutabs</span> <span class="op">*</span> <span class="va">Agutlument</span></span>
<span>    <span class="va">dAcompartment</span> <span class="op">=</span> <span class="va">kgutabs</span> <span class="op">*</span> <span class="va">Agutlument</span> <span class="op">-</span> <span class="va">ke</span> <span class="op">*</span> <span class="va">Acompartment</span></span>
<span>    <span class="va">dAmetabolized</span> <span class="op">=</span> <span class="va">ke</span> <span class="op">*</span> <span class="va">Acompartment</span></span>
<span>    <span class="va">Ccompartment</span> <span class="op">=</span> <span class="va">Acompartment</span> <span class="op">/</span> <span class="va">vdist</span> <span class="op">*</span> <span class="va">BW</span>;</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dAgutlument</span>, <span class="va">dAcompartment</span>, <span class="va">dAmetabolized</span><span class="op">)</span>, </span>
<span>         <span class="st">"Ccompartment"</span> <span class="op">=</span> <span class="va">Ccompartment</span><span class="op">)</span> </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The parameter values and initial states need to be assigned to
specific values before simulation. Here, we use the corresponding
parameter value of acetaminophen in this example. These model parameters
are derived from the <em>in-vivo</em> or <em>in-vitro</em> experiment
results. The parameter value can be generated from
<code>parameterize_1comp</code> function in <strong>httk</strong>
package as:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.epa.gov/chemical-research/rapid-chemical-exposure-and-dose-research" class="external-link">httk</a></span><span class="op">)</span></span>
<span><span class="va">pars1comp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/httk/man/parameterize_1comp.html" class="external-link">parameterize_1comp</a></span><span class="op">(</span>chem.name <span class="op">=</span> <span class="st">"acetaminophen"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pars1comp</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>vdist <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">Vdist</span>, </span>
<span>           ke <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kelim</span>, </span>
<span>           kgutabs <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kgutabs</span>, </span>
<span>           BW <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">BW</span><span class="op">)</span></span>
<span><span class="va">initState</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Agutlument <span class="op">=</span> <span class="fl">10</span>, Acompartment <span class="op">=</span> <span class="fl">0</span>, Ametabolized <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">parms</span></span></code></pre></div>
<p>The given value of <code>vdist</code>, <code>ke</code>, and
<code>kgutabs</code> in <strong>httk</strong> are 1.1 (L/kg BW), 0.23
(/h), and 2.18 (/h), respectively. The body weight is assumed to be 70
(kg).</p>
<p>Here shows the given parameter value (<code>parms</code>) and initial
state condition (<code>initState</code>) that need to specify in model
solving. Both <code>parms</code> and <code>initState</code> are “numeric
variables” that contain the value of parameter and initial state
condition.</p>
<p>Using the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode()</a></code> function in <strong>deSolve</strong>
package, we can visualize the PK profile according to the given
parameter baseline and the time points (<code>t</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>, to <span class="op">=</span> <span class="fl">24.01</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">initState</span>, times <span class="op">=</span> <span class="va">t</span>, func <span class="op">=</span> <span class="va">pbtk1cpt</span>, parms <span class="op">=</span> <span class="va">parms</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Setting up the parameter distributions. The distribution of parameter
is taken to be uniform with bounds corresponding to 50% and 200% of the
nominal value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vdist"</span>, <span class="st">"ke"</span>, <span class="st">"kgutabs"</span>, <span class="st">"BW"</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"qunif"</span>, <span class="st">"qunif"</span>, <span class="st">"qunif"</span>, <span class="st">"qnorm"</span><span class="op">)</span></span>
<span><span class="va">q.arg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">Vdist</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">Vdist</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kelim</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kelim</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kgutabs</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kgutabs</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">BW</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q.arg</span></span></code></pre></div>
<p>The parameter ranges are assumed to be 0.55 and 2.2 L/kg BW for
<code>vdist</code>. The <code>ke</code> are ranged from 0.12 to 0.47 /h,
corresponding to half-times of 1.5 and 5.8 hr. The <code>ka</code> are
ranged 1.09 to 4.36 /h. The <code>BW</code> is assumed to a normal
distribution with mean = 70 kg and sd = 5 kg.</p>
<p>Here, we set a sample size of 200 with 10 replications. Through
<code><a href="../reference/rfast99.html">rfast99()</a></code> function, a S3 object with class
<code>rfast99</code> will be created. The <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> can
use to reproduce the same parameter matrix in the random sampling. The
sample size determines the robustness of the result of SA. Higher number
of sample size lead to narrower confidence intervals for sensitivity
measurements across different replications. However, it will take a
longer time in computation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfast99.html">rfast99</a></span><span class="op">(</span><span class="va">params</span>, n <span class="op">=</span> <span class="fl">200</span>, q <span class="op">=</span> <span class="va">q</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, replicate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The generated parameters are stored as a 3-D array under the named
<code>a</code>, with the dimension of sample size, the number of
replications, and the number of parameters, respectively.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">)</span></span></code></pre></div>
<p>The sample number is 200, with 4 model parameters, which generates
800 model evaluations. The replication is set to 10. Therefore, the
total of 8,000 parameter sequence will be used to compute the
corresponding outputs. Figure plotted the sampling process for each
parameter from the first 3 replications. The search curves show the
different intensity of sampling patterns in each segment.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, pch <span class="op">=</span><span class="st">"."</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vdist"</span>, <span class="st">"ke"</span>, <span class="st">"kgutabs"</span>, <span class="st">"BW"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="va">j</span> <span class="op">==</span> <span class="st">"BW"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">j</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"BW"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">j</span><span class="op">]</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="va">j</span> <span class="op">==</span> <span class="st">"BW"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="va">i</span>,<span class="va">j</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">""</span>, yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span>  </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="va">i</span>,<span class="va">j</span><span class="op">]</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span> </span>
<span>  <span class="va">hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,,<span class="va">j</span><span class="op">]</span>, plot<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,,<span class="va">j</span><span class="op">]</span><span class="op">)</span>, to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,,<span class="va">j</span><span class="op">]</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">hist</span><span class="op">$</span><span class="va">density</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, space<span class="op">=</span><span class="fl">0</span>, horiz <span class="op">=</span> <span class="cn">T</span>, main <span class="op">=</span> <span class="va">j</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Model evaluation"</span>, <span class="va">SOUTH</span><span class="op">&lt;-</span><span class="fl">1</span>, line<span class="op">=</span><span class="fl">2</span>, outer<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Because the PK model is being used to describe a continuous process
for the chemical concentration over time, the sensitivity measurements,
therefore, have the time-dependent relationships for each model
parameter. Here we use the defined output time points (<code>t</code>)
to examine the change of the parameter sensitivity over time. To solve
the model through <strong>deSolve</strong>, we need to provide the
details of the argument, which include time (<code>t</code>), initial
conditions of state variable (<code>initState</code>), output variables
(<code>outnames</code>), and name of the model function
(<code>func</code>). To create the time-dependent sensitivity
measurement, we set the time duration from 0.01 to 24.01 hours with the
time segment of 1 hour as the above definition in <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode()</a></code>
function in this example. The initial time point should avoid 0 to
prevent computational error in misconduct. The <code>outnames</code> is
based on the arguments from the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode()</a></code> function in
<strong>deSolve</strong> package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ccompartment"</span>, <span class="st">"Ametabolized"</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_fun.html">solve_fun</a></span><span class="op">(</span><span class="va">x</span>, time <span class="op">=</span> <span class="va">t</span>, func <span class="op">=</span> <span class="va">pbtk1cpt</span>, initState <span class="op">=</span> <span class="va">initState</span>, outnames <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span></span></code></pre></div>
<p>The output result <code>out</code> is an S3 object of
<code><a href="../reference/rfast99.html">rfast99()</a></code> as well, which can link with
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, and <code><a href="../reference/check.html">check()</a></code>
method to examine the sensitivity measurements. The <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
function gives the sensitivity and convergence indices for main,
interaction, and total order at each time point. In addition to print
out the result of SA, the more efficient way to distinguish the
influence of model parameter is to visualize these indices.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p>The SI has computed range from 0 (no impact) to 1 (high impact) and
represents the contribution percentage of output variance under the
given parameter distributions. The solid line represents the total
(black) and first (red) order SI with 95% confidence interval (polygon).
The dashed line is the cut-off with the default value of 0.05.</p>
<p>Here, we can see that <code>vdist</code> and <code>ke</code> dominate
the plasma concentration before and after 5-hr post chemical intake,
respectively. The parameter <code>kgutabs</code> only plays a crucial
role to determine the plasma concentration in the first hour. However,
the current result only based on the distribution of model parameters
for APAP. Given different input conditions (e.g., range of parameter
uncertainty, chemical-dependent parameter value) the result can of
course change (result not shown).</p>
<p>The default output in the plotting is setting at the first variable.
To exam the time-dependent SI of other variables, such as
<code>Ametabolized</code> in this case, we need to assign the variable
name <code>vars = "Ametabolized"</code> in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"Ametabolized"</span><span class="op">)</span></span></code></pre></div>
<p>The amount of metabolized is also determined by parameter
<code>ke</code>. Same as <code>Ccompartment</code>, the
<code>kgutabs</code> contribute about 30 - 40% variation of model output
in the first hour. The <code>BW</code> is the least important parameter
in the current analysis, and therefore, can be fixed in the model
fitting to data and additional applications.</p>
<p>In addition to using the time-SI profile to investigate the parameter
impact on model output, we can directly examine the relationship between
parameters and model output graphically.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, pch <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"vdist"</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"0.01"</span>,<span class="fl">1</span><span class="op">]</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, main <span class="op">=</span> <span class="st">"\nvdist"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"vdist"</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"2.01"</span>,<span class="fl">1</span><span class="op">]</span>, xaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"vdist"</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"6.01"</span>,<span class="fl">1</span><span class="op">]</span>, xaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"vdist"</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="st">"24.01"</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ke"</span>, <span class="st">"kgutabs"</span>, <span class="st">"BW"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.01"</span>, <span class="st">"2.01"</span>, <span class="st">"6.01"</span>, <span class="st">"24.01"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">==</span> <span class="st">"0.01"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">k</span>,<span class="fl">1</span><span class="op">]</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\n"</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">==</span> <span class="st">"24.01"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">k</span>,<span class="fl">1</span><span class="op">]</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span>,<span class="fl">1</span>,<span class="va">k</span>,<span class="fl">1</span><span class="op">]</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="va">SOUTH</span><span class="op">&lt;-</span><span class="fl">1</span>, line<span class="op">=</span><span class="fl">2</span>, outer<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Ccompartment"</span>, <span class="va">WEST</span><span class="op">&lt;-</span><span class="fl">2</span>, line<span class="op">=</span><span class="fl">2</span>, outer<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Here shows the relationship between the concentration of the rest of
the body (<code>Ccompartment</code>) and the model parameters at times
0.01, 2.01, 6.01, and 24.01 hr (top to bottom), respectively. We can
find that <code>kgutabs</code> and <code>vdist</code> have higher
correlation with <code>Ccompartment</code> in the beginning (t = 0.01 h)
of post-intake duration compared with other parameters, suggesting that
the parameters have high impact on the modeling result. The
<code>ke</code> shows a high correlation at the later time period (t =
24.01 h). The parameter <code>BW</code> does not show any obvious
relationship with <code>Ccompartment</code>.</p>
<p>The output variable <code>out</code> containing all the input
arguments detailed above and the calculated SI of first order
(<code>mSI</code>), interaction (<code>iSI</code>), and total order
(<code>tSI</code>). Convergence indices are also stored in the list
named <code>mCI</code>, <code>iCI</code>, and <code>tCI</code>. The
outputs are formatted as 4-D array in <code>y</code> with the dimension
name of model evaluation, number of replications, number of time points,
and number of output variables, respectively.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Some functions in <strong>pksensi</strong> provide efficient ways to
check the result from global SA. The <code><a href="../reference/check.html">check()</a></code> can determine
which parameters have relatively lowered sensitivity measurement across
the given time points and model outputs, and therefore can be applied
parameter fixing in model calibration. The <code><a href="../reference/check.html">check()</a></code> also
provides an argument to specify the target output or change the cut-off
value. The argument of <code>cutoff</code> set for example at 0.05, is
used to detect the relative non-influential parameters as default, in
this case representing a 5% change of the output is contributed from the
specific parameter variation.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check.html">check</a></span><span class="op">(</span><span class="va">out</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>Based on the sensitivity measurement of the total order, the result
shows that <code>BW</code> has a relative lower measurement of SI.
However, all parameters do not converge to the setting cut-off, which
means the larger sample size is required in further sensitivity testing.
Similar to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function that can assign specific
output variable in the examination, the <code><a href="../reference/check.html">check()</a></code> function
can also use the assignment (<code>vars</code>) to examine a given
output.</p>
</div>
<div class="section level3">
<h3 id="gnu-mcsim-model-code">GNU MCSim model code<a class="anchor" aria-label="anchor" href="#gnu-mcsim-model-code"></a>
</h3>
<p>Running model under <strong>GNU MCSim</strong> native code can have a
faster speed to obtain the model outputs. This subsection will show how
to conduct global SA with <strong>deSolve</strong> package with
<strong>GNU MCSim</strong> model code.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/models.html">pbtk1cpt_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"pbtk1cpt.model"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>The code must first be compiled to run the model. After create the
model file, we can use <code><a href="../reference/compile_model.html">compile_model()</a></code> function to generate
the file that has dynamic-link library (DLL) or share object (SO)
extension and can be linked dynamically into an R session
(<code>pbtk1cpt.dll</code> on Windows or <code>pbtk1cpt.so</code> on
other systems) and R file (<code>pbtk1cpt_inits.R</code>) with default
input parameters and initial state settings with the definition of
<code>application = "R"</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mName</span> <span class="op">&lt;-</span> <span class="st">"pbtk1cpt"</span></span>
<span><span class="fu"><a href="../reference/compile_model.html">compile_model</a></span><span class="op">(</span><span class="va">mName</span>, application <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>pbtk1cpt_inits.R</code> file includes
<code>initParms</code> and <code>initStates</code> functions and
<code>Outputs</code> variable. The created function have default value
of model parameters and initial conditions that can further use to
customize in the simulation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mName</span>, <span class="st">"_inits.R"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The parameter values and initial states can be customized to the
specific condition. It can also schedule for the given dosing scenario.
In the current setting, we assumed the initial condition of the intake
dose to be 1000 mg. We can use <code>initParms</code> and
<code>initStates</code> functions to customize the parameter values and
the initial state that will be used in the following modeling and SA.
These additional functions are generated when compiling the model file.
We used the the same parameter values in this section.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu">initParms</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">parms</span><span class="op">[</span><span class="st">"vdist"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">Vdist</span></span>
<span><span class="va">parms</span><span class="op">[</span><span class="st">"ke"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kelim</span></span>
<span><span class="va">parms</span><span class="op">[</span><span class="st">"kgutabs"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">kgutabs</span></span>
<span><span class="va">parms</span><span class="op">[</span><span class="st">"BW"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars1comp</span><span class="op">$</span><span class="va">BW</span></span>
<span><span class="va">initState</span> <span class="op">&lt;-</span> <span class="fu">initStates</span><span class="op">(</span>parms<span class="op">=</span><span class="va">parms</span><span class="op">)</span></span>
<span><span class="va">initState</span><span class="op">[</span><span class="st">"Agutlument"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<p>Here shows the given parameter value (<code>parms</code>), initial
state condition (<code>initStat</code>), and the output variable
(<code>Outputs</code>) that need to specify in model solving.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parms</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initState</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Outputs</span></span></code></pre></div>
<p>Using the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode()</a></code> function in <strong>deSolve</strong>
package. Unlike above example, we have to assign additional arguments,
such as <code>dllname</code>, <code>initfunc</code>, <code>nout</code>,
and <code>outnames</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>, to <span class="op">=</span> <span class="fl">24.01</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">initState</span>, times <span class="op">=</span> <span class="va">t</span>, func <span class="op">=</span> <span class="st">"derivs"</span>, parms <span class="op">=</span> <span class="va">parms</span>, </span>
<span>         dllname <span class="op">=</span> <span class="va">mName</span>, initfunc <span class="op">=</span> <span class="st">"initmod"</span>, </span>
<span>         nout <span class="op">=</span> <span class="fl">1</span>, outnames <span class="op">=</span> <span class="va">Outputs</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Same as above, use the following code to define the parameter
distributions and generate parameter matrix.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define parameter distribution</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"qunif"</span>, <span class="st">"qunif"</span>, <span class="st">"qunif"</span>, <span class="st">"qnorm"</span><span class="op">)</span></span>
<span><span class="va">q.arg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"vdist"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"vdist"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"ke"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"ke"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"kgutabs"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"kgutabs"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"BW"</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vdist"</span>, <span class="st">"ke"</span>, <span class="st">"kgutabs"</span>, <span class="st">"BW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate parameter matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfast99.html">rfast99</a></span><span class="op">(</span><span class="va">params</span>, n <span class="op">=</span> <span class="fl">200</span>, q <span class="op">=</span> <span class="va">q</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, replicate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Run simulation and check result.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ccompartment"</span>, <span class="st">"Ametabolized"</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_fun.html">solve_fun</a></span><span class="op">(</span><span class="va">x</span>, time <span class="op">=</span> <span class="va">t</span>, initState <span class="op">=</span> <span class="va">initState</span>, outnames <span class="op">=</span> <span class="va">outputs</span>, dllname <span class="op">=</span> <span class="va">mName</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/check.html">check</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p>The simulation time had huge improvement when using <strong>GNU
MCSim</strong> model code.</p>
</div>
</div>
<div class="section level2">
<h2 id="model-implementation-with-gnu-mcsim-solving-engine">Model Implementation with <strong>GNU MCSim</strong> solving
engine<a class="anchor" aria-label="anchor" href="#model-implementation-with-gnu-mcsim-solving-engine"></a>
</h2>
<p>In addition to use <strong>deSolve</strong> to solve differential
equations in PK model, the <strong>GNU MCSim</strong> can provide better
computational efficiency. To solve ODE through <strong>GNU
MCSim</strong>, we need to change the argument to
<code>application = mcsim</code> in <code><a href="../reference/compile_model.html">compile_model()</a></code>
function. The computing time of using <code><a href="../reference/solve_fun.html">solve_fun()</a></code> function
in SA is estimated as,</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">out</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/solve_fun.html">solve_fun</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">t</span>, initState <span class="op">=</span> <span class="va">initState</span>, outnames <span class="op">=</span> <span class="va">Outputs</span>, dllname <span class="op">=</span> <span class="va">mName</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, before we conduct the SA through <strong>GNU MCSim</strong>,
The following code is used to compile the <strong>GNU MCSim</strong>
model code to the executable program.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compile_model.html">compile_model</a></span><span class="op">(</span><span class="va">mName</span>, application <span class="op">=</span> <span class="st">"mcsim"</span><span class="op">)</span></span></code></pre></div>
<p>Similar to <code><a href="../reference/solve_fun.html">solve_fun()</a></code> function that can define the
initial value of parameter and state variable through generated
functions, the <code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code> also has a
<code>condition</code> argument that can be used to give the specific
input value such as exposure dose, fixed parameter value or initial
condition of state variable.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Agutlument = 10"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span><span class="op">(</span><span class="va">x</span>, mName <span class="op">=</span> <span class="va">mName</span>, params <span class="op">=</span> <span class="va">params</span>, </span>
<span>                               vars <span class="op">=</span> <span class="va">Outputs</span>, time <span class="op">=</span> <span class="va">t</span>, </span>
<span>                               condition <span class="op">=</span> <span class="va">conditions</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>After solving the equations under the same given condition, we can
find that <strong>GNU MCSim</strong> provide faster speed in computing
performance than using <strong>deSolve</strong>. In this case, we only
focus on performing the global SA alone for generic PK model without
additional comparison with experiment data. The PBPK example will
display and reproduce our previous published result <span class="citation">(Hsieh et al. 2018)</span> with full global SA
workflow.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-JSSv002i09" class="csl-entry">
Bois, Frederic, and Don Maszle. 1997. <span>“MCSim: A Monte Carlo
Simulation Program.”</span> <em>Journal of Statistical Software,
Articles</em> 2 (9): 1–60. <a href="https://doi.org/10.18637/jss.v002.i09" class="external-link">https://doi.org/10.18637/jss.v002.i09</a>.
</div>
<div id="ref-fphar201800588" class="csl-entry">
Hsieh, Nan-Hung, Brad Reisfeld, Frederic Y. Bois, and Weihsueh A. Chiu.
2018. <span>“Applying a Global Sensitivity Analysis Workflow to Improve
the Computational Efficiencies in Physiologically-Based Pharmacokinetic
Modeling.”</span> <em>Frontiers in Pharmacology</em> 9: 588. <a href="https://doi.org/10.3389/fphar.2018.00588" class="external-link">https://doi.org/10.3389/fphar.2018.00588</a>.
</div>
<div id="ref-JSSv079i04" class="csl-entry">
Pearce, Robert, R. Woodrow Setzer, Cory Strope, Nisha Sipes, and John
Wambaugh. 2017. <span>“<span class="nocase">httk</span>: <span>R</span>
Package for High-Throughput Toxicokinetics.”</span> <em>Journal of
Statistical Software, Articles</em> 79 (4): 1–26. <a href="https://doi.org/10.18637/jss.v079.i04" class="external-link">https://doi.org/10.18637/jss.v079.i04</a>.
</div>
<div id="ref-JSSv033i09" class="csl-entry">
Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010.
<span>“Solving Differential Equations in r: Package deSolve.”</span>
<em>Journal of Statistical Software, Articles</em> 33 (9): 1–25. <a href="https://doi.org/10.18637/jss.v033.i09" class="external-link">https://doi.org/10.18637/jss.v033.i09</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nan-Hung Hsieh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
