<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Acetaminophen-PBPK model • pksensi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Acetaminophen-PBPK model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pksensi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pbpk_apap.html">Acetaminophen-PBPK model</a></li>
    <li><a class="dropdown-item" href="../articles/pbtk1cpt.html">One-compartment PK model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nanhung/pksensi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Acetaminophen-PBPK model</h1>
                        <h4 data-toc-skip class="author">Nan-Hung
Hsieh</h4>
            
            <h4 data-toc-skip class="date">2024-11-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanhung/pksensi/blob/master/vignettes/pbpk_apap.Rmd" class="external-link"><code>vignettes/pbpk_apap.Rmd</code></a></small>
      <div class="d-none name"><code>pbpk_apap.Rmd</code></div>
    </div>

    
    
<p>The aim of this vignette is to reproduce our previous published <span class="citation">(Hsieh et al. 2018)</span> result of global sensitivity
analysis for acetaminophen PBPK model through <strong>pksensi</strong>.
The model codes are included in this package and can be generated
through <code><a href="../reference/models.html">pbpk_apap_model()</a></code>. We applied the global
sensitivity analysis workflow to the original published model with 21
model parameters <span class="citation">(Zurlinden and Reisfeld
2016)</span>. The descriptions of each parameter and the sampling ranges
are list in Table 1.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mcsim.html">mcsim_install</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"6.1.0"</span><span class="op">)</span></span></code></pre></div>
<p>Same as the example of one-compartment PK model. The model parameter
and the corresponding sampling range should be defined to create the
parameter matrix. Previously, the probability distributions of model
parameters were set to either truncated normal or uniform distribution
when the parameters have informative prior information or not. To
rapidly reach the acceptance convergence, we apply uniform distribution
for all testing parameters. The ranges of informative parameters are set
to 1.96-times difference for single side under log-scaled (approximate
54.6 times difference between minimum and maximum in natural scaled).
The nominal values of informative model parameters were defined as:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nominal value</span></span>
<span><span class="va">Tg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.23</span><span class="op">)</span></span>
<span><span class="va">Tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.033</span><span class="op">)</span></span>
<span><span class="va">CYP_Km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></span>
<span><span class="va">SULT_Km_apap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">SULT_Ki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">526</span><span class="op">)</span></span>
<span><span class="va">SULT_Km_paps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">UGT_Km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">6.0e3</span><span class="op">)</span></span>
<span><span class="va">UGT_Ki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5.8e4</span><span class="op">)</span></span>
<span><span class="va">UGT_Km_GA</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Km_AG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.99e4</span><span class="op">)</span></span>
<span><span class="va">Km_AS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.29e4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rng</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> </span></code></pre></div>
<p>Generally, wide range of parameter value might cause the computing
error when solving the differential equation. One of the effective ways
to prevent this problem is to adjust the value of relative and absolute
error tolerance to control the error appearance by resetting these
parameters in a lower value. The <code><a href="../reference/solve_mcsim.html">generate_infile()</a></code> and
<code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code> provide the arguments of <code>rtol</code>
and <code>atol</code> that adjust the error tolerance to prevent the
unwanted error. However, the modification will decrease the computing
speed. Therefore, the alternative method to prevent this issue is to
detect the crucial parameter range that causes the problem. Also,
setting the maximum number of steps to higher value instead of using the
default value (500) in <strong>GNU MCSim</strong> can prevent this
problem (internally defined). The maximum number of step is set to 5000
in this case. Here we separate the global SA of APAP-PBPK model process
to several steps.</p>
<div class="section level2">
<h2 id="prepare-and-compile-the-model-file">Prepare and compile the model file<a class="anchor" aria-label="anchor" href="#prepare-and-compile-the-model-file"></a>
</h2>
<p>The model code needs to be prepared in the following global SA
workflow. After creating the <code>pbpk_apap.model</code> file in the
working directory, the next step is to generate the executable program
(<code>mcsim.pbpk_apap</code>) through <code><a href="../reference/compile_model.html">compile_model()</a></code>
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mName</span> <span class="op">&lt;-</span> <span class="st">"pbpk_apap"</span></span>
<span><span class="fu"><a href="../reference/models.html">pbpk_apap_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/compile_model.html">compile_model</a></span><span class="op">(</span><span class="va">mName</span>, application <span class="op">=</span> <span class="st">"mcsim"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-the-parameter-and-its-distribution">Define the parameter and its distribution<a class="anchor" aria-label="anchor" href="#define-the-parameter-and-its-distribution"></a>
</h2>
<p>The 21 testing model parameters are defined in this part, including
parameter name, probability distribution, and distributed parameter
value. To prevent the computing error, the range of
<code>SULT_VmaxC</code> and <code>UGT_VmaxC</code> need to adjust from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>15</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U(0, 15)</annotation></semantics></math><span class="citation">(Zurlinden and Reisfeld 2016)</span> to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>10</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U(0, 10)</annotation></semantics></math><span class="citation">(Hsieh et al. 2018)</span>. The objects
<code>q</code> and <code>dist</code> are set to the type of distribution
that will use to generate the parameter matrix in <strong>GNU
MCSim</strong> (for uncertainty analysis) and R (for SA).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnTg"</span>, <span class="st">"lnTp"</span>, <span class="st">"lnCYP_Km"</span>,<span class="st">"lnCYP_VmaxC"</span>,</span>
<span>           <span class="st">"lnSULT_Km_apap"</span>,<span class="st">"lnSULT_Ki"</span>,<span class="st">"lnSULT_Km_paps"</span>,<span class="st">"lnSULT_VmaxC"</span>,</span>
<span>           <span class="st">"lnUGT_Km"</span>,<span class="st">"lnUGT_Ki"</span>,<span class="st">"lnUGT_Km_GA"</span>,<span class="st">"lnUGT_VmaxC"</span>,</span>
<span>           <span class="st">"lnKm_AG"</span>,<span class="st">"lnVmax_AG"</span>,<span class="st">"lnKm_AS"</span>,<span class="st">"lnVmax_AS"</span>,</span>
<span>           <span class="st">"lnkGA_syn"</span>,<span class="st">"lnkPAPS_syn"</span>, <span class="st">"lnCLC_APAP"</span>,<span class="st">"lnCLC_AG"</span>,<span class="st">"lnCLC_AS"</span><span class="op">)</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uniform"</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"qunif"</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">q.arg</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tg</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Tg</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tp</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Tp</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CYP_Km</span><span class="op">-</span><span class="va">rng</span>, <span class="va">CYP_Km</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.</span>, <span class="fl">5.</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Km_apap</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Km_apap</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Ki</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Ki</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Km_paps</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Km_paps</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Km</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Km</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Ki</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Ki</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Km_GA</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Km_GA</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Km_AG</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Km_AG</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7.</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Km_AS</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Km_AS</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7.</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">13</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-additional-input-condition-and-output-time-and-variables">Define additional input condition and output time and variables<a class="anchor" aria-label="anchor" href="#define-additional-input-condition-and-output-time-and-variables"></a>
</h2>
<p>To optimize the computing speed, this case only uses <strong>GNU
MCSim</strong> to estimate the concentration of APAP and its metabolites
glucuronide (APAP-G) and sulfate (APAP-S) in plasma. The setting oral
dose of APAP is 20 mg/kg in this example. Generally, the input dosing
method can be defined through the <code>condition</code> argument. Since
the unit of the given dose is mg/kg, the <code>mgkg_flag</code> is set
to 1. More definition of input schedule functions can be found in the
section of input functions in <strong>GNU MCSim</strong> User’s Manual
(<a href="https://www.gnu.org/software/mcsim/mcsim.html#Input-functions" class="external-link uri">https://www.gnu.org/software/mcsim/mcsim.html#Input-functions</a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mgkg_flag = 1"</span>,</span>
<span>                <span class="st">"OralExp_APAP = NDoses(2, 1, 0, 0, 0.001)"</span>,</span>
<span>                <span class="st">"OralDose_APAP_mgkg = 20.0"</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnCPL_APAP_mcgL"</span>, <span class="st">"lnCPL_AG_mcgL"</span>, <span class="st">"lnCPL_AS_mcgL"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="uncertainty-analysis">Uncertainty analysis<a class="anchor" aria-label="anchor" href="#uncertainty-analysis"></a>
</h2>
<p>We apply uncertainty analysis through the <code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code>
and visualize the result by <code><a href="../reference/pksim.html">pksim()</a></code> function. Some example
data are included in the <strong>pksensi</strong> with experiment time
(h) and concentration (mg/L).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">)</span></span></code></pre></div>
<p>In the setting condition of simulation, The relative and absolute
error tolerance (<code>rtol</code> &amp; <code>atol</code>) were set to
1e-7 and 1e-9, respectively, to prevent the computing error. The Monte
Carlo simulation is run for 1000 iteration as the assignment of
<code>monte_carlo</code>. The input file (‘sim.in’) and output file
(‘simmc.out’) will be generated under the standard ASCII format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1111</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span><span class="op">(</span>mName <span class="op">=</span> <span class="va">mName</span>, params <span class="op">=</span> <span class="va">params</span>, vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>                   monte_carlo <span class="op">=</span> <span class="fl">1000</span>, dist <span class="op">=</span> <span class="va">dist</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, </span>
<span>                   time <span class="op">=</span> <span class="va">times</span>, condition <span class="op">=</span> <span class="va">conditions</span>, </span>
<span>                   rtol <span class="op">=</span> <span class="fl">1e-7</span>, atol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, ylab <span class="op">=</span> <span class="st">"Conc. (ug/L)"</span>, main <span class="op">=</span> <span class="st">"APAP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">APAP</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_AG_mcgL"</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, main <span class="op">=</span> <span class="st">"APAP-G"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">" "</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">AG</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_AS_mcgL"</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, main <span class="op">=</span> <span class="st">"APAP-S"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">" "</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">AS</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here shows the coverage checks of prior PBPK model predictions with
calibrated APAP data. For parent compound, all data points are located
in the simulated interval of 25-75%. Through this result, we can
determine that the simulated outputs can accurately generate the same
concentration profile as the in-vivo experiment under the setting of
parameter ranges for APAP. The simulated result of metabolites APAP-G
shows the different pharmacokinetic profile with experiment data.
However, all data points are located in the simulated interval.</p>
</div>
<div class="section level2">
<h2 id="generate-parameter-matrix">Generate parameter matrix<a class="anchor" aria-label="anchor" href="#generate-parameter-matrix"></a>
</h2>
<p>In global SA, we have to additionally generate the parameter matrix
from the eFAST method. The current setting uses 512 sample size with 10
replication.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfast99.html">rfast99</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>, n <span class="op">=</span> <span class="fl">512</span>, q <span class="op">=</span> <span class="va">q</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, replicate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conduct-the-global-sa">Conduct the global SA<a class="anchor" aria-label="anchor" href="#conduct-the-global-sa"></a>
</h2>
<p>To conduct the global SA with <strong>GNU MCSim</strong> and
<strong>pksensi</strong>, the input file with given “setpoint” condition
should be generated before modeling. The file can create by
<code>generate_infile</code> function. The <code>solve_mcsim</code> can
also automatically create the input file and compute the output.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span><span class="op">(</span><span class="va">x</span>, mName <span class="op">=</span> <span class="va">mName</span>,</span>
<span>                   params <span class="op">=</span> <span class="va">params</span>, </span>
<span>                   time <span class="op">=</span> <span class="va">times</span>, </span>
<span>                   vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>                   condition <span class="op">=</span> <span class="va">conditions</span>, </span>
<span>                   rtol <span class="op">=</span> <span class="fl">1e-7</span>, atol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization-and-decision">Visualization and decision<a class="anchor" aria-label="anchor" href="#visualization-and-decision"></a>
</h2>
<p>The plotting function can create the result of time-dependent
sensitivity measurement to determine the parameter impact on model
output over time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_APAP_mcgL"</span><span class="op">)</span></span></code></pre></div>
<p>In addition, through using the <code>check</code>, the parameter with
sensitivity and convergence indices over the given condition can be
preliminary detected for all output variables. Based on our previous
study, we proposed the heatmap visualization approach
<code>heat_check</code> to distinguish “influential” and
“non-influential” parameters with a “cut-off” point. Through the given
argument <code>order</code>, we can select the specific order of
sensitivity measurement that we’re interested in.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check.html">heat_check</a></span><span class="op">(</span><span class="va">out</span>, order <span class="op">=</span> <span class="st">"total order"</span>, show.all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>In the default setting, the <code>heat_check</code> can only show the
influential parameters. The argument <code>show.all</code> is used to
show all results. Adding the <code>index = "CI"</code> in the function
can further investigate the convergence index. Based on the current
setting of sampling size, most parameters cannot reach the acceptable
criteria of convergence. Therefore, a higher number of sampling is
necessary. The sample size of convergence in the current PBPK model is
8,192 <span class="citation">(Hsieh et al. 2018)</span>. However, based
on the current sample size we still can find 6 parameters that can be an
important parameter for the plasma APAP concentration.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check.html">heat_check</a></span><span class="op">(</span><span class="va">out</span>, index <span class="op">=</span> <span class="st">"CI"</span>, order <span class="op">=</span> <span class="st">"total order"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fphar201800588" class="csl-entry">
Hsieh, Nan-Hung, Brad Reisfeld, Frederic Y. Bois, and Weihsueh A. Chiu.
2018. <span>“Applying a Global Sensitivity Analysis Workflow to Improve
the Computational Efficiencies in Physiologically-Based Pharmacokinetic
Modeling.”</span> <em>Frontiers in Pharmacology</em> 9: 588. <a href="https://doi.org/10.3389/fphar.2018.00588" class="external-link">https://doi.org/10.3389/fphar.2018.00588</a>.
</div>
<div id="ref-s13318-015-0253-x" class="csl-entry">
Zurlinden, Todd J., and Brad Reisfeld. 2016. <span>“Physiologically
Based Modeling of the Pharmacokinetics of Acetaminophen and Its Major
Metabolites in Humans Using a Bayesian Population Approach.”</span>
<em>European Journal of Drug Metabolism and Pharmacokinetics</em> 41:
267–80. <a href="https://doi.org/10.1007/s13318-015-0253-x" class="external-link">https://doi.org/10.1007/s13318-015-0253-x</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nan-Hung Hsieh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
